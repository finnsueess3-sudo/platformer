<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>2D Fighter Multiplayer Demo</title>
<style>
  body { margin:0; background:#111; color:white; font-family:Arial; }
  canvas { display:block; margin:20px auto; background:#1e1e1e; border:2px solid #333; }
</style>
</head>
<body>

<canvas id="game" width="800" height="450"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const ws = new WebSocket("ws://localhost:8080");
let playerId = null;
let players = {};

ws.onmessage = (msg) => {
    const data = JSON.parse(msg.data);

    if (data.type === "init") {
        playerId = data.id;
    }

    if (data.type === "state") {
        players = data.players;
    }
};

let keys = {};
document.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
document.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

function sendInput() {
    if (!playerId) return;
    ws.send(JSON.stringify({
        type:"input",
        left: keys["a"],
        right: keys["d"],
        jump: keys["w"]
    }));
}

function draw() {
    ctx.clearRect(0,0,800,450);

    // Draw ground
    ctx.fillStyle = "#333";
    ctx.fillRect(0, 380, 800, 70);

    // Draw players
    for (let id in players) {
        const p = players[id];
        ctx.fillStyle = id === playerId ? "#4af" : "#fa4";
        ctx.fillRect(p.x, p.y, 40, 60);
    }
}

setInterval(() => {
    sendInput();
    draw();
}, 1000/60);
</script>

</body>
</html>
